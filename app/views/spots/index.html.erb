<%= GMap.header %>  

<h1>Listing spots</h1>

<%= @map.div(:width => 600, :height => 400) %>
<%= @map.to_html %>

<table>
  <tr>
    <th>name</th>
    <th>location</th>
    <th>code</th>
  </tr>

<% for spot in @spots %>
  <tr>
    <td><%=h spot.name %></td>
    <td><%=h spot.geolocation_x %> <%=h spot.geolocation_y %> </td>
    <td><%=h spot.code %></td>
    <% if logged_in? %>
      <% if current_user.can_edit_spots? %>
        <td><%= link_to 'Show', spot %></td>
        <td><%= link_to 'Edit', edit_spot_path(spot) %></td>
        <td><%= link_to 'Destroy', spot, :confirm => 'Are you sure?', :method => :delete %></td>
      <% end %>
      
      <% if current_user.can_claim_spot? %>
        <td><%= link_to "claim!", :controller => 'claims', :action => 'spot', :id => spot %></td>
      <% end %>
    <% end %>
  </tr>
<% end %>
</table>

<h2>What's going on?</h2>
<ul>
<% for claim in @recent_claims %>
  <li><%=h claim.spot.name %> was claimed by <%=h claim.user.login %></li>
<% end %>
</ul>

<br />

<% if logged_in? and current_user.can_edit_spots? %>
  <%= link_to 'New spot', new_spot_path %>
<% end %>
